(()=>{"use strict";var t,e={891:(t,e,s)=>{var n=s(710),i=s(753),o=s(961),r=s(486);class a extends r.A{constructor(t,e){super(),this.pointers=new Map,this.throttlingTime_ms=16,this.throttlingDeltas=new Map,this.hasThrottledMap=new Map,this.onTick=t=>{for(const[e,s]of this.throttlingDeltas.entries()){const n=s+t.delta;n>=this.throttlingTime_ms?(this.hasThrottledMap.set(e,!1),this.throttlingDeltas.set(e,n%this.throttlingTime_ms)):this.throttlingDeltas.set(e,n)}},this.onDocumentMouseDown=t=>{this.isContain(t)&&(this.pointers.set(t.pointerId,t),1===this.pointers.size&&this.dispatchDragEvent("drag_start",t))},this.onDocumentMouseMove=t=>{if(!this.hasThrottledMap.get(t.pointerId)){if(this.dispatchDragEvent("move",t),this.pointers.has(t.pointerId)){const e=new Map(this.pointers);if(this.pointers.set(t.pointerId,t),2===this.pointers.size&&2===e.size){const t=this.generatePinchEvent(e);this.emit(t.type,t)}else 1===this.pointers.size&&1===e.size&&this.dispatchDragEvent("drag",t,e.get(t.pointerId))}this.hasThrottledMap.set(t.pointerId,!0),this.throttlingDeltas.set(t.pointerId,0)}},this.onDocumentMouseLeave=t=>{this.onDocumentMouseUp(t)},this.onDocumentMouseUp=t=>{this.pointers.has(t.pointerId)&&1===this.pointers.size&&this.dispatchDragEvent("drag_end",t),this.pointers.delete(t.pointerId)},this.onMouseWheel=t=>{const e={type:"zoom"};null!=t.detail&&(e.deltaScroll=t.detail<0?1:-1),null!=t.deltaY&&(e.deltaScroll=t.deltaY>0?1:-1),this.emit(e.type,e)},null!=e?.throttlingTime_ms&&(this.throttlingTime_ms=e.throttlingTime_ms),null!=e?.viewport&&(this.viewport??=e.viewport.area,this.canvasRect??=e.viewport.canvasRect),this.canvas=t,this.canvas.addEventListener("pointermove",this.onDocumentMouseMove,!1),this.canvas.addEventListener("pointerdown",this.onDocumentMouseDown,!1),this.canvas.addEventListener("pointerup",this.onDocumentMouseUp,!1),this.canvas.addEventListener("pointerleave",this.onDocumentMouseLeave,!1),this.canvas.addEventListener("wheel",this.onMouseWheel,!1),o.w.on("tick",this.onTick)}generatePinchEvent(t){const e=Array.from(this.pointers.values()),s=Array.from(t.values());return{type:"pinch",delta:a.calculateDistance(e)-a.calculateDistance(s),pointers:e}}static calculateDistance(t){return Math.sqrt((t[0].offsetX-t[1].offsetX)**2+(t[0].offsetY-t[1].offsetY)**2)}dispatchDragEvent(t,e,s){const n={type:t},{x:i,y:o}=this.convertToLocalMousePoint(e);n.positionX=i,n.positionY=o,n.pointerId=e.pointerId,"drag"===t&&s&&(n.deltaX=e.offsetX-s.offsetX,n.deltaY=e.offsetY-s.offsetY),this.emit(t,n)}convertToLocalMousePoint(t){if(this.viewport&&this.canvasRect){const e=a.convertToRect(this.viewport,this.canvasRect),s=this.canvas.clientWidth/this.canvasRect.width,n=t.offsetX/s,i=t.offsetY/s;return{x:n-e.x1,y:i-e.y1}}return{x:t.offsetX,y:t.offsetY}}isContain(t){if(!this.viewport||!this.canvasRect)return!0;const e=a.convertToRect(this.viewport,this.canvasRect),s=this.canvas.clientWidth/this.canvasRect.width,n=t.offsetX/s,i=t.offsetY/s;return n>=e.x1&&n<=e.x2&&i>=e.y1&&i<=e.y2}static convertToRect(t,e){return{x1:t.x,x2:t.x+t.width,y1:e.height-(t.y+t.height),y2:e.height-t.y}}reset(){this.pointers.clear()}dispose(){this.canvas.removeEventListener("pointermove",this.onDocumentMouseMove,!1),this.canvas.removeEventListener("pointerdown",this.onDocumentMouseDown,!1),this.canvas.removeEventListener("pointerup",this.onDocumentMouseUp,!1),this.canvas.removeEventListener("pointerleave",this.onDocumentMouseLeave,!1),o.w.off("tick",this.onTick)}}class h extends r.A{constructor(t,e){super(),this.dragWatcher=t,this.timeOut_ms=1e4,this.isSleep=!1,this.restart=()=>{this.stopTimer(),this.wakeup(),this.sleepTimerID=window.setTimeout(this.sleep,this.timeOut_ms)},this.sleep=()=>{this.isSleep||(this.emit("sleep",{type:"sleep"}),this.isSleep=!0)},this.wakeup=()=>{this.isSleep&&(this.emit("wakeup",{type:"wakeup"}),this.isSleep=!1)},this.pauseTimer=()=>{this.stopTimer(),this.wakeup();const t=this.dragWatcher;t.off("drag_start",this.pauseTimer),t.on("drag_end",this.resumeTimer)},this.resumeTimer=()=>{this.restart();const t=this.dragWatcher;t.on("drag_start",this.pauseTimer),t.off("drag_end",this.resumeTimer)},e||(e={}),null!=e.timeOut_ms&&(this.timeOut_ms=e.timeOut_ms)}reset(){this.restart()}stopTimer(){null!=this.sleepTimerID&&(clearTimeout(this.sleepTimerID),this.sleepTimerID=void 0)}start(){this.stopMouseEventListeners(),this.startMouseEventListeners(),this.restart()}startMouseEventListeners(){const t=this.dragWatcher;t.on("zoom",this.restart),t.on("drag_start",this.pauseTimer)}stop(){this.stopTimer(),this.wakeup(),this.stopMouseEventListeners()}stopMouseEventListeners(){const t=this.dragWatcher;t.off("zoom",this.restart),t.off("drag_start",this.pauseTimer),t.off("drag_end",this.resumeTimer)}}const p=t=>`hsl(${137.508*t%360}, 70%, 50%)`;window.onload=()=>{const t=document.createElement("div");t.style.cssText="\n    position: fixed;\n    top: 10px;\n    right: 10px;\n    background: rgba(0, 0, 0, 0.7);\n    color: white;\n    padding: 10px;\n    font-family: monospace;\n    pointer-events: none;\n    z-index: 1000;\n  ",document.body.appendChild(t);const e=document.createElement("div");e.style.cssText="\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    z-index: 1000;\n  ",document.body.appendChild(e);const s=new n.Z58,o=new n.ubm(45,2,1,1e4);o.position.set(0,0,1e3),s.add(o);const r={canvas:document.getElementById("webgl-canvas")},c=new i.JeP(r);c.setClearColor(new n.Q1f(0)),c.setSize(1280,640),c.setPixelRatio(window.devicePixelRatio);const d=new n.$p8(16777215,1);s.add(d),c.render(s,o);const l=new a(c.domElement);l.on("drag",(s=>{const n=performance.now().toFixed(2);t.innerHTML=`\n      Status: drag<br>\n      Time: ${n}ms<br>\n      throttlingTime_ms: ${l.throttlingTime_ms}<br>\n      Pointer ID: ${s.pointerId}<br>\n      Position: (${s.positionX}, ${s.positionY})<br>\n      Delta: (${s.deltaX??0}, ${s.deltaY??0})\n    `,e.innerHTML="";const i=document.createElement("div"),o=p(s.pointerId);i.style.cssText=`\n      position: absolute;\n      left: ${s.positionX}px;\n      top: ${s.positionY}px;\n      width: 80px;\n      height: 80px;\n      border-radius: 50%;\n      background: ${o};\n      transform: translate(-50%, -50%);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: white;\n      font-weight: bold;\n    `,i.textContent=s.pointerId,e.appendChild(i)})),l.on("drag_start",(s=>{const n=performance.now().toFixed(2);t.innerHTML=`\n      Status: drag_start<br>\n      Time: ${n}ms<br>\n      Pointer ID: ${s.pointerId}<br>\n      Position: (${s.positionX}, ${s.positionY})\n    `,e.innerHTML="";const i=document.createElement("div"),o=p(s.pointerId);i.style.cssText=`\n      position: absolute;\n      left: ${s.positionX}px;\n      top: ${s.positionY}px;\n      width: 80px;\n      height: 80px;\n      border-radius: 50%;\n      background: ${o};\n      transform: translate(-50%, -50%);\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      color: white;\n      font-weight: bold;\n    `,i.textContent=s.pointerId,e.appendChild(i)})),l.on("drag_end",(s=>{const n=performance.now().toFixed(2);t.innerHTML=`\n      Status: drag_end<br>\n      Time: ${n}ms<br>\n      Pointer ID: ${s.pointerId}<br>\n      Position: (${s.positionX}, ${s.positionY})\n    `,e.innerHTML=""})),l.on("zoom",(t=>{console.log(t)}));const m=new h(l,{timeOut_ms:2e3});m.on("sleep",(t=>{console.log(t)})),m.on("wakeup",(t=>{console.log(t)})),m.start(),c.domElement.style.touchAction="none"}}},s={};function n(t){var i=s[t];if(void 0!==i)return i.exports;var o=s[t]={exports:{}};return e[t](o,o.exports,n),o.exports}n.m=e,t=[],n.O=(e,s,i,o)=>{if(!s){var r=1/0;for(c=0;c<t.length;c++){for(var[s,i,o]=t[c],a=!0,h=0;h<s.length;h++)(!1&o||r>=o)&&Object.keys(n.O).every((t=>n.O[t](s[h])))?s.splice(h--,1):(a=!1,o<r&&(r=o));if(a){t.splice(c--,1);var p=i();void 0!==p&&(e=p)}}return e}o=o||0;for(var c=t.length;c>0&&t[c-1][2]>o;c--)t[c]=t[c-1];t[c]=[s,i,o]},n.d=(t,e)=>{for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.j=795,(()=>{var t={795:0};n.O.j=e=>0===t[e];var e=(e,s)=>{var i,o,[r,a,h]=s,p=0;if(r.some((e=>0!==t[e]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(h)var c=h(n)}for(e&&e(s);p<r.length;p++)o=r[p],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(c)},s=self.webpackChunk_masatomakino_threejs_drag_watcher=self.webpackChunk_masatomakino_threejs_drag_watcher||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))})();var i=n.O(void 0,[121],(()=>n(891)));i=n.O(i)})();