(()=>{"use strict";var t,e={389:(t,e,n)=>{var s=n(961),o=n(486);class i extends o.A{constructor(t,e){super(),this.pointers=new Map,this.throttlingTime_ms=16,this.throttlingDeltas=new Map,this.hasThrottledMap=new Map,this.onTick=t=>{for(const[e,n]of this.throttlingDeltas.entries()){const s=n+t.delta;s>=this.throttlingTime_ms?(this.hasThrottledMap.set(e,!1),this.throttlingDeltas.set(e,s%this.throttlingTime_ms)):this.throttlingDeltas.set(e,s)}},this.onDocumentMouseDown=t=>{this.isContain(t)&&(this.pointers.set(t.pointerId,t),1===this.pointers.size&&this.dispatchDragEvent("drag_start",t))},this.onDocumentMouseMove=t=>{if(!this.hasThrottledMap.get(t.pointerId)){if(this.dispatchDragEvent("move",t),this.pointers.has(t.pointerId)){const e=new Map(this.pointers);if(this.pointers.set(t.pointerId,t),2===this.pointers.size&&2===e.size){const t=this.generatePinchEvent(e);this.emit(t.type,t)}else 1===this.pointers.size&&1===e.size&&this.dispatchDragEvent("drag",t,e.get(t.pointerId))}this.hasThrottledMap.set(t.pointerId,!0),this.throttlingDeltas.set(t.pointerId,0)}},this.onDocumentMouseLeave=t=>{this.onDocumentMouseUp(t)},this.onDocumentMouseUp=t=>{this.pointers.has(t.pointerId)&&1===this.pointers.size&&this.dispatchDragEvent("drag_end",t),this.pointers.delete(t.pointerId)},this.onMouseWheel=t=>{const e={type:"zoom"};null!=t.detail&&(e.deltaScroll=t.detail<0?1:-1),null!=t.wheelDelta&&(e.deltaScroll=t.wheelDelta>0?1:-1),null!=t.deltaY&&(e.deltaScroll=t.deltaY>0?1:-1),this.emit(e.type,e)},null!=e?.throttlingTime_ms&&(this.throttlingTime_ms=e.throttlingTime_ms),null!=e?.viewport&&(this.viewport??=e.viewport.area,this.canvasRect??=e.viewport.canvasRect),this.canvas=t,this.canvas.addEventListener("pointermove",this.onDocumentMouseMove,!1),this.canvas.addEventListener("pointerdown",this.onDocumentMouseDown,!1),this.canvas.addEventListener("pointerup",this.onDocumentMouseUp,!1),this.canvas.addEventListener("pointerleave",this.onDocumentMouseLeave,!1),this.canvas.addEventListener("wheel",this.onMouseWheel,!1),s.w.on("tick",this.onTick)}generatePinchEvent(t){const e=Array.from(this.pointers.values()),n=Array.from(t.values());return{type:"pinch",delta:i.calculateDistance(e)-i.calculateDistance(n),pointers:e}}static calculateDistance(t){return Math.sqrt(Math.pow(t[0].offsetX-t[1].offsetX,2)+Math.pow(t[0].offsetY-t[1].offsetY,2))}dispatchDragEvent(t,e,n){const s={type:t},{x:o,y:i}=this.convertToLocalMousePoint(e);s.positionX=o,s.positionY=i,s.pointerId=e.pointerId,"drag"===t&&n&&(s.deltaX=e.offsetX-n.offsetX,s.deltaY=e.offsetY-n.offsetY),this.emit(t,s)}convertToLocalMousePoint(t){if(this.viewport&&this.canvasRect){const e=i.convertToRect(this.viewport,this.canvasRect),n=this.canvas.clientWidth/this.canvasRect.width,s=t.offsetX/n,o=t.offsetY/n;return{x:s-e.x1,y:o-e.y1}}return{x:t.offsetX,y:t.offsetY}}isContain(t){if(!this.viewport||!this.canvasRect)return!0;const e=i.convertToRect(this.viewport,this.canvasRect),n=this.canvas.clientWidth/this.canvasRect.width,s=t.offsetX/n,o=t.offsetY/n;return s>=e.x1&&s<=e.x2&&o>=e.y1&&o<=e.y2}static convertToRect(t,e){return{x1:t.x,x2:t.x+t.width,y1:e.height-(t.y+t.height),y2:e.height-t.y}}reset(){this.pointers.clear()}dispose(){this.canvas.removeEventListener("pointermove",this.onDocumentMouseMove,!1),this.canvas.removeEventListener("pointerdown",this.onDocumentMouseDown,!1),this.canvas.removeEventListener("pointerup",this.onDocumentMouseUp,!1),this.canvas.removeEventListener("pointerleave",this.onDocumentMouseLeave,!1),s.w.off("tick",this.onTick)}}o.A,window.onload=()=>{const t=document.getElementById("webgl-canvas"),e=document.createElement("div");e.style.cssText="\n    position: fixed;\n    top: 10px;\n    right: 10px;\n    background: rgba(0, 0, 0, 0.7);\n    color: white;\n    padding: 10px;\n    font-family: monospace;\n    pointer-events: none;\n    z-index: 1000;\n  ",document.body.appendChild(e);const n=document.createElement("div");n.style.cssText="\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    pointer-events: none;\n    z-index: 1000;\n  ",document.body.appendChild(n);const s=new i(t);s.on("pinch",(t=>{const o=performance.now().toFixed(2);if(e.innerHTML=`\n      Time: ${o}ms<br>\n      Delta: ${t.delta.toFixed(2)}<br>\n      Active Pointers: ${t.pointers.length}<br>\n      Pointer IDs: ${t.pointers.map((t=>t.pointerId)).join(", ")}<br>\n      Throttling: ${s.throttlingTime_ms}ms\n    `,n.innerHTML="",t.pointers.forEach((t=>{const e=document.createElement("div"),s=`hsl(${137.508*t.pointerId%360}, 70%, 50%)`;e.style.cssText=`\n        position: absolute;\n        left: ${t.offsetX}px;\n        top: ${t.offsetY}px;\n        width: 200px;\n        height: 200px;\n        border-radius: 50%;\n        background: ${s};\n        transform: translate(-50%, -50%);\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: white;\n        font-size: 48px;\n        font-weight: bold;\n      `,e.textContent=t.pointerId,n.appendChild(e)})),2===t.pointers.length){const[e,s]=t.pointers,o=document.createElement("div"),i=s.offsetX-e.offsetX,r=s.offsetY-e.offsetY,a=Math.sqrt(i*i+r*r),h=Math.atan2(r,i)*(180/Math.PI);o.style.cssText=`\n        position: absolute;\n        left: ${e.offsetX}px;\n        top: ${e.offsetY}px;\n        width: ${a}px;\n        height: 2px;\n        background: rgba(255, 255, 255, 0.5);\n        transform: rotate(${h}deg);\n        transform-origin: left center;\n      `,n.appendChild(o)}})),t.style.touchAction="none"}}},n={};function s(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}};return e[t](i,i.exports,s),i.exports}s.m=e,t=[],s.O=(e,n,o,i)=>{if(!n){var r=1/0;for(p=0;p<t.length;p++){for(var[n,o,i]=t[p],a=!0,h=0;h<n.length;h++)(!1&i||r>=i)&&Object.keys(s.O).every((t=>s.O[t](n[h])))?n.splice(h--,1):(a=!1,i<r&&(r=i));if(a){t.splice(p--,1);var c=o();void 0!==c&&(e=c)}}return e}i=i||0;for(var p=t.length;p>0&&t[p-1][2]>i;p--)t[p]=t[p-1];t[p]=[n,o,i]},s.d=(t,e)=>{for(var n in e)s.o(e,n)&&!s.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),s.j=779,(()=>{var t={779:0};s.O.j=e=>0===t[e];var e=(e,n)=>{var o,i,[r,a,h]=n,c=0;if(r.some((e=>0!==t[e]))){for(o in a)s.o(a,o)&&(s.m[o]=a[o]);if(h)var p=h(s)}for(e&&e(n);c<r.length;c++)i=r[c],s.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return s.O(p)},n=self.webpackChunk_masatomakino_threejs_drag_watcher=self.webpackChunk_masatomakino_threejs_drag_watcher||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})();var o=s.O(void 0,[121],(()=>s(389)));o=s.O(o)})();